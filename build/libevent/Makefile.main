
SRCDIR=../../deps/libevent
export CFLAGS=-fPIC

all:
	if [ ! -d $(SRCDIR) ]; then \
		cd $(dir $(SRCDIR)); \
		git clone --single-branch --branch release-2.1.8-stable https://github.com/libevent/libevent.git; \
	fi
	if [ ! -f $(SRCDIR)/configure ]; then \
		cd $(SRCDIR); \
		./autogen.sh; \
	fi
	echo ### 3
	if [ ! -f Makefile ]; then \
		$(SRCDIR)/configure; \
	fi
	$(MAKE)

clean:
ifeq ($(ALL),1) 
	rm -rf $(SRCDIR)
	find . \( ! -name "Makefile.main" \) -delete
else
	$(MAKE) clean
endif
